
# ORGANELLE_OS_RasPi

Connettore espansione pisound:
pin 9 (BCM27) -> Led Blu
pin 7 (BCM22) -> Led verde
pin 8 (BCM23) -> led Rosso
Il comune del led va a +5V (viene accesso da pin LOW)

pin 5 (BCM5) -> encoder Button
pin 6 (BCM6) -> encoder DT
pin 3 (BCM7) -> encoder CLK
Il positivo dell'encoder va alimentato a 3.3V

The operating system for the BARBONELLE synthesizer device - remixed for barbons

Il pulsante PiSound e' su GPIO 17 (Pin 11, Wiring Pi pin 0).

########### Installazione da barboni ###########

Scaricare raspbian con lite
PRIMA (e sottolineo il PRIMA) di inzepparlo del raspoberro:

   sudo nano /run/media/io/rootfs/usr/lib/raspi-config/init_resize.h
   cambiare la linea
      ROOT_DEV_SIZE=$(cat "/sys/block/${ROOT_DEV_NAME}/size")
   in
      ROOT_DEV_SIZE=9437184
quindi... procedere. Questo fara' in modo che la partizione root sia di circa 4 gigaspazi.
Una volta che il raspoberro ha resizato a dovere la partizione root, arimettere la sdcard nel PC
e creare una ulteriore partizione ext4 utilizzando tutto lo spazio rimasto nella SD.

sudo raspi-config: 
- configurare WLAN
- Change password: music
- Network > Hostname: barbonelle
- abilitare SSH
. Locale: en US UTF8-UTF8

--- Exit, Reboot
                                     
relogin (attenzione: ora la password Ã¨ music)
sudo apt-get update
sudo apt-get upgrade -y
sudo reboot

creare utente "music":

1  `sudo passwd root`  --> cambiare la password in "root" (!)
2. logout, login as root
Creare user 'music':
  usermod -l music -d /home/music -m pi
  groupmod --new-name music pi

logout, quindi login as music

disable need for passwd with sudo:
sudo passwd -l root
sudo nano /etc/sudoers.d/010_pi-nopasswd
change 'pi' to 'music'
- con raspi-config, abilitare console autologin
poweroff



git clone https://github.com/The-XOR/ORGANELLE_OS.git --depth=1
cd ORGANELLE_OS

Note - EYESY is looking for your sound card to be the "default" device.
Inserire nello slotto usbo la sound card che si intende utilizzare (per es la cara vecchia barbonger uca222) aplay -l Si ottiene un output tipo questo:

**** List of PLAYBACK Hardware Devices **** card 1: CODEC [USB Audio CODEC], device 0: USB Audio [USB Audio] Subdevices: 1/1 Subdevice #0: subdevice #0

annotarsi il n. di card della scheda che si vuole utilizzare

cd ~/ORGANELLE_OS/config 
nano asound.conf <----- inserire qui il numero di card annotato in precedenza (per default, 1)

   
./deploy.sh
reboot  

./deploy2.sh


startx
Avviare puredata

### Control:

+++++ LEMUR!
Implementanta una splendida patch per Lemur, molto piu completa di quella fatta con TouchOSC

**Control via TouchOSC:**
- Download and install the TouchOSC app for your iOS or Android device (it is not free, I've been looking for free/open-source alternatives, please let me know if you know one; nevertheless, this app is well developed and it's also nice to suppot this kind of effort I believe)
- Copiare il profilo touchosc sul device da utilizzare and import it via the app (in Layout).
- In the OSC setting of the app set Host to the ip adress of your pi (your device and your pi must be on the same network)
- Set the outgoing port to `4000` and ingoing to `4001`
- You're `Done`!
 
 
**Control via midi in messages (should be plug and play):**
  | Midi CC    | 21,22,23,24 | 25               | 26               | 27               | 28                | 29                | 30              | 31        | 32           | 33              | 34                         | 35       |
  |-------|-------------|------------------|----------------------|-------------------|---------------------|-----------|--------------|-----------------|----------------------------|----------|------------|----------------|
  | Control | Mode Params | Background Color | Scene selection | Save or delete (long hold) | Auto Clear Toggle | Mode Selection | Take Screenshot | Info Disp | Send Trigger | ShiftKey | Input Gain | Trigger Source |


### Web Editor
The web editor lets you edit the pygame scripts that generate the visuals on the fly. It should be accessible at http://eyesy.local:8080/ (or IP:8080 where IP is the current ip adress of your Pi)

See the Eyesy manual for more details on using the web editor.

### Rem:

- You can use the stereo input in your Modes, in Python there are accessible via `etc.audio_left` and `etc.audio_right` in the scripts, `etc.audio_in` remains L+R

